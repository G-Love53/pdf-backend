<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>ACORD 126 – Commercial General Liability</title>
  <style>
    /* Embedded print-like styling to match your 125 sheet */
    @page { size: Letter; margin: 36pt; }
    body { font-family: Arial, Helvetica, sans-serif; color:#111; }
    .page { page-break-inside: avoid; }
    .pagebreak { page-break-before: always; }

    .headerbar {
      display:flex; align-items:center; justify-content:space-between;
      border:2px solid #000; padding:10pt 12pt; margin-bottom:10pt; background:#f5f5f5;
    }
    .headerbar .acord { font-weight:700; letter-spacing:0.5pt; }
    .headerbar .title { font-weight:700; text-transform:uppercase; }
    .headerbar .formno {
      font-weight:700; border-left:1px solid #999; padding-left:10pt; margin-left:10pt;
    }

    .subbar {
      background:#000; color:#fff; font-weight:700; padding:6pt 8pt;
      margin:14pt 0 6pt; letter-spacing:0.2pt;
    }
    .block { border:1px solid #000; padding:8pt; }
    .row { display:flex; flex-wrap:wrap; border-bottom:1px solid #ddd; }
    .row:last-child { border-bottom:none; }
    .cell { padding:6pt 6pt; box-sizing:border-box; }
    .label { font-weight:700; background:#fafafa; border-right:1px solid #eee; }

    .w10{width:10%}.w15{width:15%}.w20{width:20%}.w25{width:25%}.w30{width:30%}
    .w35{width:35%}.w40{width:40%}.w50{width:50%}.w60{width:60%}.w70{width:70%}
    .w75{width:75%}.w80{width:80%}.w90{width:90%}.w100{width:100%}
    .right { text-align:right; }

    .check {
      display:inline-block; min-width:14pt; text-align:center; border:1px solid #000; margin-right:6pt; font-weight:700;
      width:14pt; height:14pt; line-height:12pt; vertical-align:middle; font-size:10pt;
    }
    .legal { font-size:10pt; line-height:1.3; }
  </style>
</head>
<body>
<% const { yn, x, money, moneyUSD, yesno, isYes, formatDate, join } = helpers; %>

  <div class="page">
    <div class="headerbar">
      <div class="acord">ACORD</div>
      <div class="title">COMMERCIAL GENERAL LIABILITY SECTION</div>
      <div class="formno">126</div>
    </div>

    <!-- Applicant -->
    <div class="subbar">APPLICANT</div>
    <div class="block">
      <div class="row">
        <div class="cell label w25">NAME</div>
        <div class="cell w75"><%= data.applicant_name || "" %></div>
      </div>
      <div class="row">
        <div class="cell label w25">PREMISES</div>
        <div class="cell w75"><%= join([data.premise_address, data.premise_city, data.premise_state, data.premise_zip]) %></div>
      </div>
    </div>

    <!-- Exposures (kept minimal) -->
    <div class="subbar">EXPOSURES</div>
    <div class="block">
      <div class="row">
        <div class="cell label w25">TOTAL SALES</div>
        <div class="cell w25 right"><%= moneyUSD(data.total_sales) %></div>
        <div class="cell label w25">ALCOHOL SALES</div>
        <div class="cell w25 right"><%= moneyUSD(data.alcohol_sales) %></div>
      </div>
      <div class="row">
        <div class="cell label w25">SQUARE FOOTAGE</div>
        <div class="cell w25 right"><%= data.square_footage || "" %></div>
        <div class="cell label w25">OCCUPANCY</div>
        <div class="cell w25"><%= data.occupancy || data.max_occupancy || "" %></div>
      </div>
    </div>

    <!-- Additional Interest(s) -->
    <div class="subbar">ADDITIONAL INTEREST</div>
    <div class="block">

      <% 
        // Support both 1-up fields and an array payload.
        // Priority: explicit 1..5 fields; then fallback to an array `additional_interests`.
        const aiBlocks = [];

        function pushAI(name, addr, city, state, zip, types) {
          if (!name && !addr && !city && !state && !zip) return;
          aiBlocks.push({
            name: name || "",
            addressLine: join([addr, city, state, zip])
              || "",
            types: types || {}
          });
        }

        // 1-up fields (v1 mapping)
        pushAI(
          data.ai_name_1, data.ai_address_1, data.ai_city_1, data.ai_state_1, data.ai_zip_1,
          {
            addl: data.ai_additional_insured,
            loss: data.ai_loss_payee,
            mort: data.ai_mortgagee,
            lien: data.ai_lienholder
          }
        );
        // Optional second–fifth blocks if you add them later (safe if not present)
        pushAI(
          data.ai_name_2, data.ai_address_2, data.ai_city_2, data.ai_state_2, data.ai_zip_2,
          { addl: data.ai_additional_insured_2, loss: data.ai_loss_payee_2, mort: data.ai_mortgagee_2, lien: data.ai_lienholder_2 }
        );
        pushAI(
          data.ai_name_3, data.ai_address_3, data.ai_city_3, data.ai_state_3, data.ai_zip_3,
          { addl: data.ai_additional_insured_3, loss: data.ai_loss_payee_3, mort: data.ai_mortgagee_3, lien: data.ai_lienholder_3 }
        );
        pushAI(
          data.ai_name_4, data.ai_address_4, data.ai_city_4, data.ai_state_4, data.ai_zip_4,
          { addl: data.ai_additional_insured_4, loss: data.ai_loss_payee_4, mort: data.ai_mortgagee_4, lien: data.ai_lienholder_4 }
        );
        pushAI(
          data.ai_name_5, data.ai_address_5, data.ai_city_5, data.ai_state_5, data.ai_zip_5,
          { addl: data.ai_additional_insured_5, loss: data.ai_loss_payee_5, mort: data.ai_mortgagee_5, lien: data.ai_lienholder_5 }
        );

        // Array fallback (v2 mapping): data.additional_interests = [{name, address, city, state, zip, additional_insured, loss_payee, mortgagee, lienholder}, ...]
        if (Array.isArray(data.additional_interests)) {
          data.additional_interests.forEach(it => {
            pushAI(
              it.name, it.address, it.city, it.state, it.zip,
              { addl: it.additional_insured, loss: it.loss_payee, mort: it.mortgagee, lien: it.lienholder }
            );
          });
        }

        const hasAI = aiBlocks.length > 0;
      %>

      <% if (hasAI) { %>
        <% aiBlocks.forEach((ai, idx) => { %>
          <div class="row">
            <div class="cell label w20">NAME</div>
            <div class="cell w40"><%= ai.name %></div>
            <div class="cell label w10">TYPE</div>
            <div class="cell w30">
              <span class="check"><%= isYes(ai.types.addl) ? "✓" : "" %></span> Addl Insured
              <span class="check"><%= isYes(ai.types.loss) ? "✓" : "" %></span> Loss Payee
              <span class="check"><%= isYes(ai.types.mort) ? "✓" : "" %></span> Mortgagee
              <span class="check"><%= isYes(ai.types.lien) ? "✓" : "" %></span> Lienholder
            </div>
          </div>
          <div class="row" style="<%= idx < aiBlocks.length-1 ? 'border-bottom:1px solid #bbb' : '' %>">
            <div class="cell label w20">ADDRESS</div>
            <div class="cell w80"><%= ai.addressLine %></div>
          </div>
        <% }) %>
      <% } else { %>
        <div class="row">
          <div class="cell w100" style="color:#666;">No additional interests provided.</div>
        </div>
      <% } %>
    </div>

    <!-- Remarks -->
    <div class="subbar">REMARKS</div>
    <div class="block">
      <div class="row">
        <div class="cell w100" style="min-height:60pt;"><%= data.remarks || "" %></div>
      </div>
    </div>
  </div>

  <!-- Signature / Legal -->
  <div class="page pagebreak">
    <div class="headerbar">
      <div class="acord">ACORD</div>
      <div class="title">COMMERCIAL GENERAL LIABILITY SECTION</div>
      <div class="formno">126</div>
    </div>

    <div class="subbar">SIGNATURE</div>
    <div class="block">
      <div class="row">
        <div class="cell label w30">APPLICANT’S SIGNATURE</div>
        <div class="cell w70">&nbsp;</div>
      </div>
      <div class="row">
        <div class="cell label w30">TITLE</div>
        <div class="cell w30">&nbsp;</div>
        <div class="cell label w20">DATE</div>
        <div class="cell w20"><%= formatDate() %></div>
      </div>
    </div>

    <div class="subbar">LEGAL NOTICE</div>
    <div class="block">
      <div class="row">
        <div class="cell w100">
          <div class="legal">
            The undersigned authorized representative of the applicant declares that all statements are true and complete…
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>


